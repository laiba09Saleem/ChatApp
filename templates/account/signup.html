{% extends "base.html" %}
{% load static %}
{% load i18n %}

{% block head_title %}{% trans "Sign Up" %}{% endblock %}

{% block content %}
<div class="auth-container">
    <div class="auth-card">
        <div class="auth-header">
            <h2>{% trans "Create Account" %}</h2>
            <p>{% trans "Join our chat community today!" %}</p>
        </div>

        {% if form.errors %}
        <div class="alert alert-error">
            <i class="fas fa-exclamation-circle"></i>
            {% trans "Please correct the errors below." %}
        </div>
        {% endif %}

        <form class="auth-form" method="POST" action="{% url 'account_signup' %}">
            {% csrf_token %}
            
            <div class="form-group">
                <label for="id_email">
                    <i class="fas fa-envelope"></i> {% trans "Email" %}
                </label>
                <input type="email" name="email" id="id_email" 
                       placeholder="Enter your email" 
                       value="{{ form.email.value|default:'' }}" required>
                {% if form.email.errors %}
                <div class="error-text">{{ form.email.errors }}</div>
                {% endif %}
            </div>

            <div class="form-group">
                <label for="id_username">
                    <i class="fas fa-user"></i> {% trans "Username" %}
                </label>
                <input type="text" name="username" id="id_username" 
                       placeholder="Choose a username" 
                       value="{{ form.username.value|default:'' }}" required>
                {% if form.username.errors %}
                <div class="error-text">{{ form.username.errors }}</div>
                {% endif %}
            </div>

            <div class="form-group">
                <label for="id_first_name">
                    <i class="fas fa-user-circle"></i> {% trans "First Name" %}
                </label>
                <input type="text" name="first_name" id="id_first_name" 
                       placeholder="Enter your first name" 
                       value="{{ form.first_name.value|default:'' }}">
            </div>

            <div class="form-group">
                <label for="id_last_name">
                    <i class="fas fa-user-circle"></i> {% trans "Last Name" %}
                </label>
                <input type="text" name="last_name" id="id_last_name" 
                       placeholder="Enter your last name" 
                       value="{{ form.last_name.value|default:'' }}">
            </div>

            <div class="form-group">
                <label for="id_password1">
                    <i class="fas fa-lock"></i> {% trans "Password" %}
                </label>
                <input type="password" name="password1" id="id_password1" 
                       placeholder="Create a password" required>
                <div class="password-toggle">
                    <i class="fas fa-eye" id="togglePassword1"></i>
                </div>
                {% if form.password1.errors %}
                <div class="error-text">{{ form.password1.errors }}</div>
                {% endif %}
                <div class="password-hints">
                    <small>{% trans "Your password must contain:" %}</small>
                    <ul>
                        <li>{% trans "At least 8 characters" %}</li>
                        <li>{% trans "Not too common" %}</li>
                        <li>{% trans "Not entirely numeric" %}</li>
                    </ul>
                </div>
            </div>

            <div class="form-group">
                <label for="id_password2">
                    <i class="fas fa-lock"></i> {% trans "Confirm Password" %}
                </label>
                <input type="password" name="password2" id="id_password2" 
                       placeholder="Confirm your password" required>
                <div class="password-toggle">
                    <i class="fas fa-eye" id="togglePassword2"></i>
                </div>
                {% if form.password2.errors %}
                <div class="error-text">{{ form.password2.errors }}</div>
                {% endif %}
            </div>

            {% if redirect_field_value %}
            <input type="hidden" name="{{ redirect_field_name }}" value="{{ redirect_field_value }}" />
            {% endif %}

            <div class="form-check">
                <input type="checkbox" name="terms" id="id_terms" required>
                <label for="id_terms">
                    {% trans "I agree to the" %} 
                    <a href="#" class="terms-link">{% trans "Terms of Service" %}</a> 
                    {% trans "and" %} 
                    <a href="#" class="terms-link">{% trans "Privacy Policy" %}</a>
                </label>
            </div>

            <button type="submit" class="btn btn-primary btn-block">
                <i class="fas fa-user-plus"></i> {% trans "Create Account" %}
            </button>

            <div class="auth-footer">
                {% trans "Already have an account?" %}
                <a href="{% url 'account_login' %}" class="auth-link">{% trans "Sign In" %}</a>
            </div>
        </form>
    </div>
</div>

<script>
    // Password toggles
    const togglePassword1 = document.getElementById('togglePassword1');
    const passwordInput1 = document.getElementById('id_password1');
    const togglePassword2 = document.getElementById('togglePassword2');
    const passwordInput2 = document.getElementById('id_password2');
    
    togglePassword1.addEventListener('click', function() {
        const type = passwordInput1.getAttribute('type') === 'password' ? 'text' : 'password';
        passwordInput1.setAttribute('type', type);
        this.classList.toggle('fa-eye');
        this.classList.toggle('fa-eye-slash');
    });
    
    togglePassword2.addEventListener('click', function() {
        const type = passwordInput2.getAttribute('type') === 'password' ? 'text' : 'password';
        passwordInput2.setAttribute('type', type);
        this.classList.toggle('fa-eye');
        this.classList.toggle('fa-eye-slash');
    });
</script>
{% endblock %}